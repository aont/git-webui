# git-webui

A minimal aiohttp-based web interface for applying user-provided patches to GitHub repositories with `git apply --3way -v`, committing, and pushing the result.

## Features

- Clone a repository over SSH (or HTTPS) using a provided URL.
- Optional branch selection/creation.
- Configure git user name and email before committing by selecting from a predefined list.
- Choose an SSH private key path from a predefined list.
- Upload a patch via the browser and apply it with `git apply --3way -v`.
- Commit with a custom message and push the result, all while streaming detailed logs back to the UI for troubleshooting.

## Requirements

- Python 3.10+
- Dependencies listed in `requirements.txt`

Install dependencies:

```bash
pip install -r requirements.txt
```

## Usage

```bash
python app.py
```

The application listens on `http://0.0.0.0:8080/` by default.

1. Enter the repository SSH URL (HTTPS is also supported when credentials are already configured).
2. Optionally specify a target branch. If the branch does not exist it will be created.
3. Select a git user (name & email) from the configured list to apply to the cloned repository before committing.
4. Choose an SSH private key path from the configured list if pushing over SSH is required.
5. Paste the patch content (as generated by `git diff` or similar).
6. Enter a (potentially multi-line) commit message. If omitted the application will apply the patch but skip commit/push.
7. Submit the form to run the automated workflow. All git command outputs and errors appear in the log section so you can diagnose failures.

## Configuration

The application reads `config.json` (or the path specified via the `GIT_WEBUI_CONFIG` environment variable) on startup. The file must be a JSON object with two lists:

```json
{
  "ssh_keys": [
    { "label": "Example SSH Key", "path": "/home/user/.ssh/id_ed25519" }
  ],
  "git_users": [
    { "label": "Example User", "name": "Example User", "email": "user@example.com" }
  ]
}
```

- `ssh_keys`: the path is used directly with `ssh -i`. The label is shown in the dropdown.
- `git_users`: the name/email pair is applied via `git config` when selected.

If either list is empty the corresponding dropdown shows that no options are available.

## Notes

- The application uses temporary directories for cloning repositories and cleans them automatically once processing finishes.
- Logs include timestamps (UTC) for each command and their outputs, helping identify at which step a failure occurred.
- The web UI does not persist any sensitive data such as SSH keys or patches.
